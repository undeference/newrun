# This file is part of newrun, copyright Â© 2011 M. Kristall

## Config variables
# PIPEFILE	name of the pipe file (something like .tremded_pipe?)

if [[ "$PIPEFILE" == "" ]]; then
	warn "$_NAME: PIPEFILE is not set"
	exit 2
fi

pipefile="$HOMEPATH/$GAMENAME/$PIPEFILE"

_pipe_available () {
	isrunning && [ -p "$pipefile" ] && return 0
	return 1
}

pipeCmd () {
	if _pipe_available; then
		stringify "$@" > "$pipefile"
	fi
}

pipeStartCmd () {
	push STARTCMD +set com_pipefile "$PIPEFILE"
}

pipeStop () {
	if _pipe_available; then
		Cmd quit "$(stringify "$@")"
		forcequit
	else
		warn "$_NAME: server is not running?"
		exit 255
	fi
	removepid
}
